syntax = "proto3";

package api;
option go_package = "followup/api";
import "google/api/annotations.proto";

import "workitem.proto";
import "relate.proto";

import "openapi/v3/annotations.proto";
import "models/dbmodel.proto";


service Plan {
  //方案表数据添加
  rpc PlanCreate (PlanCreateRequest) returns (PlanCreateResponse) {
    option(google.api.http) = {
      post: "/plan",
      body: "*"
    };
    option (openapi.v3.operation) = {
      summary: "方案表数据添加";
    };
  };

  //方案表数据删除
  rpc PlanDelById (PlanDelByIdRequest) returns (PlanDelByIdResponse) {
    option (google.api.http) = {
      delete: "/plan",
    };
    option (openapi.v3.operation) = {
      summary: "方案表数据删除";
    };
  }

  //方案表数据更新
  rpc  PlanUpdate(PlanUpdateRequest) returns (PlanUpdateResponse) {
    option (google.api.http) = {
      put: "/plan",
      body: "data",
    };
    option (openapi.v3.operation) = {
      summary: "方案表数据更新";
    };
  }
  rpc PlanDetail (PlanDetailRequest) returns (PlanDetailResponse) {
    option (google.api.http) = {
      get: "/plan"
    };
    option (openapi.v3.operation) = {
      summary: "方案表数据详情查询";
    };
  }
  //方案表数据过滤查询
  rpc PlanFilterQuery (PlanFilterQueryRequest) returns (PlanFilterQueryResponse) {
    option (google.api.http) = {
      post: "/plan/filter",
      body: "*"
    };
    option (openapi.v3.operation) = {
      summary: "方案表数据过滤查询";
    };
  };
}

message PlanUpdateReq {
  string belongTo = 1;
  string belongType = 2;
  string frequencyUnit = 3;
  string name = 4;
  string type = 5;
}

message SaPlanDetailPreload {
  models.Plan Plan = 1;
  repeated SaPlanRelate SaPlanRelates = 2;
}

message SaPlanRelate {
  models.PlanRelate PlanRelate = 1;
  SaPlanWorkItemRelate SaPlanWorkItemRelate = 2;
}

message SaPlanWorkItemRelate {
  WorkItems WorkItem = 1;
  repeated Relates Relates = 2;
}

message SaPlanCreateReq {
  string belongType = 1;
  string belongTo = 2;
  string name = 3;
  string status = 4;
  repeated models.PlanRelate planRelates = 5;
}

message SaPlanCreateResp {
  string id = 1;
}

message SaPlanUpdateReq {
  string name = 1;
  string status = 2;
  string updateTime = 3;
  repeated models.PlanRelate planRelates = 4;
  repeated string DeletedPlanRelateIds = 5;
  //  QueryParams queryParams = 6;
}

message SaPlanUpdateResp {
  models.Plan plans = 1;
}

message ToUpdatePlanResource {
  models.Plan plans = 1;
  repeated WorkItems ToCreateWorkItem = 2;
  repeated string ToDeleteWorkItemIds = 3;
  repeated WorkItems ToUpdateWorkItem = 4;
  repeated Relates ToCreateRelate = 5;
  repeated string ToDeleteWorkItemRelateIds = 6;
  repeated models.PlanRelate ToCreatePlanRelate = 7;
  repeated string  ToDeletePlanRelate = 8;
  repeated models.PlanRelate ToUpdatePlanRelate = 9;
  repeated Relates ToUpdateRelate = 10;
}

message SapLanEventCreateReq {
  string planId = 1;
  string event = 2;
  string exeArea = 3;
  string notifyLeftOffset = 4;
  string notifyOffsetUnit = 5;
  int32 notifyRightOffset = 6;
  repeated string formId = 7;
  uint32 frequencyInterval = 8;
  string FrequencyUnit = 9;
  int32 TotalTimes = 10;
  string description = 11;
}



//message PlanBean {
//  option (openapi.v3.schema) = {
//    required:["id", "name", "type", "status", "belongType"]
//  };
//  string id = 1 [(openapi.v3.property) = {description:"id;varchar(45);方案编码"}];
//  string name = 2 [(openapi.v3.property) = {description:"name;varchar(128);方案名称"}];
//  string type = 3 [(openapi.v3.property) = {description:"type;enum('SA','FOLLOWUP');方案类型(SA 症状评估, FOLLOWUP 随访)"}];
//  string status = 4 [(openapi.v3.property) = {description:"status;enum('DRAFT','ENABLED','DISABLED');方案状态('DRAFT 草稿', 'ENABLED 启用', 'DISABLED 禁用')"}];
//  string belongType = 5 [(openapi.v3.property) = {description:"belong_type;enum('ORG','PROJECT','TEAM','GROUP','NONE');归属类型(组织、项目、团队、组等)"}];
//  optional string belongTo = 6 [(openapi.v3.property) = {description:"belong_to;varchar(45);规则资源编码(e.g. 如果归属类型时是项目则填项目编码)"}];
//  optional string applyDisease = 7 [(openapi.v3.property) = {description:"apply_disease;text;适用病种"}];
//  optional string applyDysfunction = 8 [(openapi.v3.property) = {description:"apply_dysfunction;text;适用功能障碍(多个功能障碍用','分隔)"}];
//  optional string applyAges = 9 [(openapi.v3.property) = {description:"apply_ages;text;适用年龄段(多个年龄段用','分隔)"}];
//  optional string event = 10 [(openapi.v3.property) = {description:"event;text;事件(随访开始触发事件)"}];
//  optional string creatorId = 11 [(openapi.v3.property) = {description:"creator_id;varchar(45);创建人编码"}];
//  optional string creatorName = 12 [(openapi.v3.property) = {description:"creator_name;varchar(45);创建人编码"}];
//  optional string appId = 13 [(openapi.v3.property) = {description:"app_id;varchar(45);应用编码"}];
//  optional string notifyNode = 14 [(openapi.v3.property) = {description:"notify_node;varchar(255);推送时间节点,多个值用逗号','分隔"}];
//  optional string createTime = 15 [(openapi.v3.property) = {description:"create_time;datetime;创建时间"}];
//  optional string updateTime = 16 [(openapi.v3.property) = {description:"update_time;datetime;更新时间"}];
//  optional string deleteAt = 17 [(openapi.v3.property) = {description:"delete_at;datetime;删除时间"}];
//}

message PlanCreateReqWorkItems {
  PlanCreateReqWorkItem workItem = 1;
  repeated PlanCreateReqRelates  relates = 2;
}


message PlanCreateReqWorkItem {
  string id = 1;
  string belongType = 2;
  string event = 3;
  uint32 frequencyInterval = 4;
  string frequencyUnit = 5;
  string principalType = 6;
  uint32 sortNum = 7;
  string status = 8;
  string title = 10;
  string type = 11;

}
message PlanCreateReqRelates {
  string id = 1;
  string resourceType = 2;
  string resourceId = 3;
  string status = 4;
  string title = 5;
}

message  PlanDetailPreloadInfo {
  models.Plan plan = 1;
  repeated models.PlanRelate planRelates = 2;
}

//新增
message PlanCreateRequest {
  option (openapi.v3.schema) = {
    required:["id", "name", "type", "status", "belongType"]
  };
  string name = 2 [(openapi.v3.property) = {description:"name;varchar(128);方案名称"}];
  string type = 3 [(openapi.v3.property) = {description:"type;enum('SA','FOLLOWUP');方案类型(SA 症状评估, FOLLOWUP 随访)"}];
  string status = 4 [(openapi.v3.property) = {description:"status;enum('DRAFT','ENABLED','DISABLED');方案状态('DRAFT 草稿', 'ENABLED 启用', 'DISABLED 禁用')"}];
  string belongType = 5 [(openapi.v3.property) = {description:"belong_type;enum('ORG','PROJECT','TEAM','GROUP','NONE');归属类型(组织、项目、团队、组等)"}];
  optional string belongTo = 6 [(openapi.v3.property) = {description:"belong_to;varchar(45);规则资源编码(e.g. 如果归属类型时是项目则填项目编码)"}];
  repeated string relateDiseases = 7 [(openapi.v3.property) = {description:"管理病种编码"}];
  repeated string relateDysfunction = 8 [(openapi.v3.property) = {description:"管理功能障碍编码"}];
  repeated string applyAges = 9 [(openapi.v3.property) = {description:"适用年龄阶段"}];
  //  optional string applyDisease = 7 [(openapi.v3.property) = {description:"apply_disease;text;适用病种"}];
  //  optional string applyDysfunction = 8 [(openapi.v3.property) = {description:"apply_dysfunction;text;适用功能障碍(多个功能障碍用','分隔)"}];
  //  optional string applyAges = 9 [(openapi.v3.property) = {description:"apply_ages;text;适用年龄段(多个年龄段用','分隔)"}];
  optional string event = 10 [(openapi.v3.property) = {description:"event;text;事件(随访开始触发事件)"}];
  //  optional string creatorId = 11 [(openapi.v3.property) = {description:"creator_id;varchar(45);创建人编码"}];
  //  optional string creatorName = 12 [(openapi.v3.property) = {description:"creator_name;varchar(45);创建人编码"}];
  //  optional string appId = 13 [(openapi.v3.property) = {description:"app_id;varchar(45);应用编码"}];
  //  optional string notifyNode = 14 [(openapi.v3.property) = {description:"notify_node;varchar(255);推送时间节点,多个值用逗号','分隔"}];
  //  optional string createTime = 15 [(openapi.v3.property) = {description:"create_time;datetime;创建时间"}];
  //  optional string updateTime = 16 [(openapi.v3.property) = {description:"update_time;datetime;更新时间"}];
  //  optional string deleteAt = 17 [(openapi.v3.property) = {description:"delete_at;datetime;删除时间"}];



  repeated CreatePlanWorkItemBean workItems = 11 [(openapi.v3.property) = {description:"适用年龄阶段"}];

}


message CreatePlanWorkItemBean {
  CreatePlanWorkItem workItem = 1;
  repeated CreatePlanWorkItemRelate relates = 2;
}
message CreatePlanWorkItem {
  option (openapi.v3.schema) = {
    required:["title", "type", "status", "event", "frequencyInterval", "frequencyUnit"]
  };
  optional string title = 2 [(openapi.v3.property) = {description:"title;varchar(255);标题"}];
  string type = 3 [(openapi.v3.property) = {description:"type;enum('TASK','SA','TREAT','FOLLOW_UP','WORK_FLOW');工作项类型(FOLLOW_UP:随访,SA:症状评估,TREAT:治疗任务,WORK_FLOW:工作流)"}];
  string status = 4 [(openapi.v3.property) = {description:"status;enum('MODEL','DRAFT','NEW','ACTIVE','RESOLVED','CLOSED','REMOVED');状态('MODEL 模板', 'DRAFT 草稿', 'NEW 新建-待处理', 'ACTIVE 正在进行', 'RESOLVED', 'CLOSED 已关闭', 'REMOVED 已移除')"}];
  optional string tag = 10 [(openapi.v3.property) = {description:"tag;text;标签(多个值用','分隔)"}];
  optional uint32 sortNum = 24 [(openapi.v3.property) = {description:"sort_num;int(10) unsigned;排序号码"}];
  string event = 25 [(openapi.v3.property) = {description:"event;enum('RY','SS','CY','JZ','CS','RC','NONE');触发事件('RY 入院','SS 手术', 'CY 出院', 'JZ 就诊', 'CS 出生','RC 入组','NONE')"}];
  optional int32 frequencyInterval = 26 [(openapi.v3.property) = {description:"frequency_interval;int(11);频次间隔"}];
  optional string frequencyUnit = 27 [(openapi.v3.property) = {description:"frequency_unit;enum('DAY','WEEK','MONTH','YEAR','NONE');频次单位(年,月,周,日,小时)"}];
  optional string description = 36 [(openapi.v3.property) = {description:"description;text;描述(可存富文本内容或Markdown内容)"}];
}

message CreatePlanWorkItemRelate {
  option (openapi.v3.schema) = {
    required:["title", "status", "resourceType", "resourceId"]
  };
  string title = 2 [(openapi.v3.property) = {description:"title;varchar(255);标题(根据关联资源类型决定)"}];
  string status = 3 [(openapi.v3.property) = {description:"status;enum('NEW','ACTIVE','CLOSED');关联资源状态('NEW 待处理', 'ACTIVE 正在处理 'CLOSED 已关闭')"}];
  string resourceType = 4 [(openapi.v3.property) = {description:"resource_type;enum('PLAN','FORM','WORK_ITEM','ARTICLE','FU_WC','FU_M','RM_FZ','RM_YH','RM_HY','RM_SS','NONE');工作项关联资源类型ENUM('PLAN 方案', 'FORM 表单', 'WORK_ITEM 工作项', 'ARTICLE 宣教文章', 'FU_WC 微信随访', 'FU_M 电话随访', 'RM_FZ 复诊提醒', 'RM_YH 用药提醒', 'RM_HY 换药提醒', 'RM_SS 手术提醒', 'NONE')"}];
  string resourceId = 5 [(openapi.v3.property) = {description:"resource_id;varchar(45);关联资源编码"}];
  optional string comments = 8 [(openapi.v3.property) = {description:"comments;varchar(255);描述"}];
}


message PlanCreateResponse {
  option (openapi.v3.schema) = {
    required:["id"]
  };
  string id = 1[(openapi.v3.property) = {description:"方案编码"}];
}

//删除
message PlanDelByIdRequest {
  string id = 1[(openapi.v3.property) = {description:"方案编码",required:["id"]}];
  //  QueryParams queryParams = 2;
}

message PlanDelByIdResponse {
  string id = 1[(openapi.v3.property) = {description:"方案编码",required:["id"]}];
}

//更新
message PlanUpdateRequest {
  option (openapi.v3.schema) = {
    required:["id","data"]
  };
  string id = 1 [(openapi.v3.property) = {description:"id;varchar(45);方案编码"}];
  PlanUpdateBody data = 2;
}

message PlanUpdateBody {
  option (openapi.v3.schema) = {
    required:["planBasisUpdate","planWorkItemUpdate"]
  };
  //  方案基本信息更新
  PlanBasisUpdate planBasisUpdate = 1;
  //  repeated RelateDysfunction relateDysfunctions = 2[(openapi.v3.property) = {description:"适用功能障碍",required:["relateDysfunction"]}];
  //  repeated string applyAges = 3[(openapi.v3.property) = {description:"(适用年龄段",required:["applyAges"]}];
  //  方案工作项目信息更新
  PlanWorkItemUpdate planWorkItemUpdate = 2;
}

message PlanWorkItemUpdate {
  //  方案被删除的工作项信息
  PlanDeletedWorkItemInfo planDeletedWorkItemInfo = 1;
  repeated UpdatePlanWorkItemBean workItems = 3;
}

message UpdatePlanWorkItemBean {
  UpdatePlanWorkItem workItem = 1;
  repeated UpdatePlanWorkItemRelate relates = 2;
}

message PlanDeletedWorkItemInfo {
  //  repeated string diseaseRelateIds = 1;
  repeated string workItemIds = 2;
  repeated string workItemRelateIds = 3;
}


message RelateDysfunction {
  option (openapi.v3.schema) = {
    required:["dysFuncName", "dysFuncId"]
  };
  string dysFuncName = 1[(openapi.v3.property) = {description:"功能障碍名称"}];
  string dysFuncId = 2[(openapi.v3.property) = {description:"功能障碍编码"}];
}
message PlanBasisUpdate {
  option (openapi.v3.schema) = {
    required:["name", "type", "status", "event"]
  };
  string name = 2 [(openapi.v3.property) = {description:"name;varchar(128);方案名称"}];
  repeated string relateDiseases = 7 [(openapi.v3.property) = {description:"管理病种编码"}];
  repeated string relateDysfunction = 8 [(openapi.v3.property) = {description:"管理功能障碍编码"}];
  repeated string applyAges = 9 [(openapi.v3.property) = {description:"适用年龄阶段"}];
  //  string type = 3 [(openapi.v3.property) = {description:"type;enum('SA','FOLLOWUP');方案类型(SA 症状评估, FOLLOWUP 随访)"}];
  //  string status = 4 [(openapi.v3.property) = {description:"status;enum('DRAFT','ENABLED','DISABLED');方案状态('DRAFT 草稿', 'ENABLED 启用', 'DISABLED 禁用')"}];
  string event = 5 [(openapi.v3.property) = {description:"event;text;事件(随访开始触发事件)"}];
}


message UpdatePlanWorkItem {
  option (openapi.v3.schema) = {
    required:["id", "title", "type", "status", "event", "frequencyInterval", "frequencyUnit"]
  };
  optional string id = 1 [(openapi.v3.property) = {description:"id;varchar(45);方案编码"}];
  optional string title = 2 [(openapi.v3.property) = {description:"title;varchar(255);标题"}];
  string type = 3 [(openapi.v3.property) = {description:"type;enum('TASK','SA','TREAT','FOLLOW_UP','WORK_FLOW');工作项类型(FOLLOW_UP:随访,SA:症状评估,TREAT:治疗任务,WORK_FLOW:工作流)"}];
  string status = 4 [(openapi.v3.property) = {description:"status;enum('MODEL','DRAFT','NEW','ACTIVE','RESOLVED','CLOSED','REMOVED');状态('MODEL 模板', 'DRAFT 草稿', 'NEW 新建-待处理', 'ACTIVE 正在进行', 'RESOLVED', 'CLOSED 已关闭', 'REMOVED 已移除')"}];
  optional string tag = 10 [(openapi.v3.property) = {description:"tag;text;标签(多个值用','分隔)"}];
  optional uint32 sortNum = 24 [(openapi.v3.property) = {description:"sort_num;int(10) unsigned;排序号码"}];
  string event = 25 [(openapi.v3.property) = {description:"event;enum('RY','SS','CY','JZ','CS','RC','NONE');触发事件('RY 入院','SS 手术', 'CY 出院', 'JZ 就诊', 'CS 出生','RC 入组','NONE')"}];
  optional int32 frequencyInterval = 26 [(openapi.v3.property) = {description:"frequency_interval;int(11);频次间隔"}];
  optional string frequencyUnit = 27 [(openapi.v3.property) = {description:"frequency_unit;enum('DAY','WEEK','MONTH','YEAR','NONE');频次单位(年,月,周,日,小时)"}];
  optional string description = 36 [(openapi.v3.property) = {description:"description;text;描述(可存富文本内容或Markdown内容)"}];


  //  string id = 1 [(openapi.v3.property) = {description:"id;varchar(45);工作项编码"}];
  //  optional string title = 2 [(openapi.v3.property) = {description:"title;varchar(255);标题"}];
  //  string type = 3 [(openapi.v3.property) = {description:"type;enum('TASK','SA','TREAT','FOLLOW_UP','WORK_FLOW');工作项类型(FOLLOW_UP:随访,SA:症状评估,TREAT:治疗任务,WORK_FLOW:工作流)"}];
  //  string status = 4 [(openapi.v3.property) = {description:"status;enum('MODEL','DRAFT','NEW','ACTIVE','RESOLVED','CLOSED','REMOVED');状态('MODEL 模板', 'DRAFT 草稿', 'NEW 新建-待处理', 'ACTIVE 正在进行', 'RESOLVED', 'CLOSED 已关闭', 'REMOVED 已移除')"}];
  //  optional string principalType = 5 [(openapi.v3.property) = {description:"principal_type;enum('USER','MEMBER','NONE');负责人类型('USER', 'MEMBER', 'NONE')"}];
  //  optional string principalId = 6 [(openapi.v3.property) = {description:"principal_id;varchar(45);负责人成员编码"}];
  //  optional string principalName = 7 [(openapi.v3.property) = {description:"principal_name;varchar(128);负责人姓名"}];
  //  optional string participant = 8 [(openapi.v3.property) = {description:"participant;text;参与者成员编码(多个值用','分隔)"}];
  //  optional string cc = 9 [(openapi.v3.property) = {description:"cc;text;抄送成员编码(多个值用','分隔)"}];
  //  optional string tag = 10 [(openapi.v3.property) = {description:"tag;text;标签(多个值用','分隔)"}];
  //  optional string pid = 11 [(openapi.v3.property) = {description:"pid;varchar(45);父工作项编码"}];
  //  string assignedType = 12 [(openapi.v3.property) = {description:"assigned_type;enum('USER','MEMBER','PATIENT','NONE');指派类型(用户,成员,患者,未指派)"}];
  //  optional string assignedTo = 13 [(openapi.v3.property) = {description:"assigned_to;text;指派给谁(多个值用','分隔)"}];
  //  optional string assignedToName = 14 [(openapi.v3.property) = {description:"assigned_to_name;varchar(128);被指派人姓名"}];
  //  optional string planStartTime = 15 [(openapi.v3.property) = {description:"plan_start_time;datetime;计划开始时间"}];
  //  optional string planEndTime = 16 [(openapi.v3.property) = {description:"plan_end_time;datetime;计划结束时间"}];
  //  optional string actualStartTime = 17 [(openapi.v3.property) = {description:"actual_start_time;datetime;实际开始时间"}];
  //  optional string actualEndTime = 18 [(openapi.v3.property) = {description:"actual_end_time;datetime;实际结束时间"}];
  //  optional string creatBy = 19 [(openapi.v3.property) = {description:"creat_by;varchar(45);创建人成员编码"}];
  //  optional string creatByName = 20 [(openapi.v3.property) = {description:"creat_by_name;varchar(128);创建人姓名"}];
  //  optional string updateBy = 21 [(openapi.v3.property) = {description:"update_by;varchar(45);最近更新人成员编码"}];
  //  string belongType = 22 [(openapi.v3.property) = {description:"belong_type;enum('ORG','PROJECT','TEAM','GROUP','NONE');归属类型"}];
  //  optional string belongTo = 23 [(openapi.v3.property) = {description:"belong_to;varchar(45);规则资源编码(e.g. 如果归属类型是项目则填项目编码)"}];
  //  optional uint32 sortNum = 24 [(openapi.v3.property) = {description:"sort_num;int(10) unsigned;排序号码"}];
  //  string event = 25 [(openapi.v3.property) = {description:"event;enum('RY','SS','CY','JZ','CS','RC','NONE');触发事件('RY 入院','SS 手术', 'CY 出院', 'JZ 就诊', 'CS 出生','RC 入组','NONE')"}];
  //  optional int32 frequencyInterval = 26 [(openapi.v3.property) = {description:"frequency_interval;int(11);频次间隔"}];
  //  optional string frequencyUnit = 27 [(openapi.v3.property) = {description:"frequency_unit;enum('DAY','WEEK','MONTH','YEAR','NONE');频次单位(年,月,周,日,小时)"}];
  //  optional string appId = 28 [(openapi.v3.property) = {description:"app_id;varchar(45);应用编码"}];
  //  optional int32 notifyLeftOffset = 29 [(openapi.v3.property) = {description:"notify_left_offset;int(11);通知左偏移"}];
  //  optional int32 notifyRightOffset = 30 [(openapi.v3.property) = {description:"notify_right_offset;int(11);通知右偏移"}];
  //  optional string notifyOffsetUnit = 31 [(openapi.v3.property) = {description:"notify_offset_unit;enum('DAY','WEEK','MONTH','YEAR','NONE');通知偏移时间单位"}];
  //  optional string notifyLeftDate = 32 [(openapi.v3.property) = {description:"notify_left_date;datetime;通知开始时间"}];
  //  optional string notifyRightDate = 33 [(openapi.v3.property) = {description:"notify_right_date;datetime;通知截止时间"}];
  //  optional string notifyNode = 34 [(openapi.v3.property) = {description:"notify_node;varchar(255);推送时间节点,多个值用逗号','分隔"}];
  //  optional string execArea = 35 [(openapi.v3.property) = {description:"exec_area;enum('INSIDE','OUTSIDE','NONE');执行区域(院内,院外)"}];
  //  optional string description = 36 [(openapi.v3.property) = {description:"description;text;描述(可存富文本内容或Markdown内容)"}];
  //  optional string createTime = 37 [(openapi.v3.property) = {description:"create_time;datetime;创建时间"}];
  //  optional string updateTime = 38 [(openapi.v3.property) = {description:"update_time;datetime;更新时间"}];
}

message UpdatePlanWorkItemRelate {
  option (openapi.v3.schema) = {
    required:["title", "status", "resourceType", "resourceId"]
  };
  optional string id = 1 [(openapi.v3.property) = {description:"id;varchar(45);工作项关联编码"}];
  string title = 2 [(openapi.v3.property) = {description:"title;varchar(255);标题(根据关联资源类型决定)"}];
  string status = 3 [(openapi.v3.property) = {description:"status;enum('NEW','ACTIVE','CLOSED');关联资源状态('NEW 待处理', 'ACTIVE 正在处理 'CLOSED 已关闭')"}];
  string resourceType = 4 [(openapi.v3.property) = {description:"resource_type;enum('PLAN','FORM','WORK_ITEM','ARTICLE','FU_WC','FU_M','RM_FZ','RM_YH','RM_HY','RM_SS','NONE');工作项关联资源类型ENUM('PLAN 方案', 'FORM 表单', 'WORK_ITEM 工作项', 'ARTICLE 宣教文章', 'FU_WC 微信随访', 'FU_M 电话随访', 'RM_FZ 复诊提醒', 'RM_YH 用药提醒', 'RM_HY 换药提醒', 'RM_SS 手术提醒', 'NONE')"}];
  string resourceId = 5 [(openapi.v3.property) = {description:"resource_id;varchar(45);关联资源编码"}];

  //  string id = 1 [(openapi.v3.property) = {description:"id;varchar(45);工作项关联编码"}];
  //  string title = 2 [(openapi.v3.property) = {description:"title;varchar(255);标题(根据关联资源类型决定)"}];
  //  string status = 3 [(openapi.v3.property) = {description:"status;enum('NEW','ACTIVE','CLOSED');关联资源状态('NEW 待处理', 'ACTIVE 正在处理 'CLOSED 已关闭')"}];
  //  string resourceType = 4 [(openapi.v3.property) = {description:"resource_type;enum('PLAN','FORM','WORK_ITEM','ARTICLE','FU_WC','FU_M','RM_FZ','RM_YH','RM_HY','RM_SS','NONE');工作项关联资源类型ENUM('PLAN 方案', 'FORM 表单', 'WORK_ITEM 工作项', 'ARTICLE 宣教文章', 'FU_WC 微信随访', 'FU_M 电话随访', 'RM_FZ 复诊提醒', 'RM_YH 用药提醒', 'RM_HY 换药提醒', 'RM_SS 手术提醒', 'NONE')"}];
  //  string resourceId = 5 [(openapi.v3.property) = {description:"resource_id;varchar(45);关联资源编码"}];
  //  optional string conclusion = 6 [(openapi.v3.property) = {description:"conclusion;text;结论"}];
  //  optional string suggestion = 7 [(openapi.v3.property) = {description:"suggestion;text;建议"}];
  //  optional string comments = 8 [(openapi.v3.property) = {description:"comments;varchar(255);描述"}];
  //  string createTime = 9 [(openapi.v3.property) = {description:"create_time;datetime;创建时间"}];
  //  string updateTime = 10 [(openapi.v3.property) = {description:"update_time;datetime;更新时间"}];
  //  string tbWorkItemId = 11 [(openapi.v3.property) = {description:"tb_work_item_id;varchar(45);工作项编码"}];

}




message PlanUpdateResponse {
  string belongTo = 1[(openapi.v3.property) = {description:"'规则资源编码(e.g. 如果归属类型时是项目则填项目编码)'",required:["belongTo"]}];
  string belongType = 2[(openapi.v3.property) = {description:"'归属类型(组织、项目、团队、组等)'",required:["belongType"]}];
  string createTime = 3[(openapi.v3.property) = {description:"创建时间",required:["createTime"]}];
  string frequencyUnit = 4;
  string id = 5[(openapi.v3.property) = {description:"方案编码",required:["id"]}];
  string name = 6[(openapi.v3.property) = {description:"方案名称",required:["name"]}];
  string status = 7[(openapi.v3.property) = {description:"'方案状态('DRAFT 草稿', 'ENABLED 启用', 'DISABLED 禁用')'",required:["status"]}];
  string type = 8[(openapi.v3.property) = {description:"'方案类型(SA 症状评估, FOLLOWUP 随访)'",required:["type"]}];
  string updateTime = 9[(openapi.v3.property) = {description:"更新时间",required:["updateTime"]}];
}



//查询
message  PlanDetailRequest {
  option (openapi.v3.schema) = {
    required:["id"]
  };
  string id = 1 [(openapi.v3.property) = {description:"id;varchar(45);方案编码"}];
}

message PlanDetailResponse {
  models.Plan plan = 1;
  repeated PlanRelateWorkItem relateWorkItems = 2;
  repeated PlanRelateDisease relateDiseases = 3;
  repeated  PlanRelateDysfunction relateDysfunctions = 4;
}

message PlanRelateWorkItem {
  models.PlanRelate planRelate = 1;
  models.WorkItem workItem = 2;
  repeated models.Relate relates = 3;
}
message PlanRelateDisease {
  models.PlanRelate planRelate = 1;
  models.Disease disease = 2;

}
message PlanRelateDysfunction {
  models.PlanRelate planRelate = 1;
  models.DisFunc disFunc = 2;

}

//详情查询
message PlanFilterQueryRequest {

  message Filter {
    string belongType = 1[(openapi.v3.property) = {description:"'方案类型(SA 症状评估, FOLLOWUP 随访)'"}];
    string belongTo = 2[(openapi.v3.property) = {description:"'规则资源编码(e.g. 如果归属类型时是项目则填项目编码)'",required:["belongTo"]}];
    string frequencyUnit = 3[(openapi.v3.property) = {description:"频率",required:["frequencyUnit"]}];
    repeated string ids = 4;
    string key = 5;
    string type = 6;
    string status = 7;
  }

  Filter filter = 1;
  int32 page = 2;
  int32 perPage = 3;
  //  HeaderParams HeaderParams = 4;
}

message PlanFilterQueryResponse {
  int32 page = 1;
  int32 perPage = 2;
  repeated models.Plan results = 3;
  int64 total = 4;
}